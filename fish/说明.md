# README - 栅格地图路径规划算法对比系统

## 🧭 项目概述
本项目实现并对比了多种经典与进化类路径规划算法，所有算法基于统一的 20×20 栅格地图进行路径搜索，支持八方向移动（包括斜对角），并通过可视化对比展示各自的路径效果与总代价。

支持的算法包括：
- **A***：经典启发式路径搜索算法，最优、完备，适用于结构明确场景；
- **RRT**：快速随机树，适合高维或动态环境搜索，非最优，但高效；
- **GA（遗传算法）**：基于种群演化的搜索策略，适合复杂路径结构优化；
- **AFSA（人工鱼群算法）**：仿生优化算法，模拟鱼群行为迭代收敛；
- **GFSA（融合算法）**：利用 AFSA 提供高质量种群初始化，结合 GA 演化优势。

用户可在算法模块字典 `algorithms` 中选择任意一种或多种算法参与对比实验。

## 📁 项目结构

### 🔧 1. 全局配置与工具函数
- `MOVE_DIRECTIONS`：定义上下左右及四个对角的 8 种移动方式。
- `move_cost()`：用于估算每个方向的移动代价（对角线为 sqrt(2)，直线为 1）。
- `path_cost()`：统计任意路径的总代价，作为算法目标函数。
- `distance()`：计算两点之间的欧几里得距离。
- `generate_random_path_from()`：从起点出发随机走向终点，返回一条可行路径。

### 🗺 2. 地图构建与环境封装
- `generate_fixed_grid()`：生成带固定障碍的 20x20 地图。
- `GridEnvironment` 类：封装地图结构、起终点位置和合法邻居查询。
  - `get_neighbors(cell)`：返回该位置的所有合法邻居坐标，支持斜对角角落穿越检查。

### 🤖 3. 算法模块与原理说明

#### ✅ A* 算法（`algorithm_AStar`）
- **核心思想**：以 `f(n) = g(n) + h(n)` 为代价函数，其中 g 为当前累计代价，h 为到目标的启发估计。
- **数据结构**：使用 `heapq` 最小堆作为 open_set，记录当前最优扩展节点。
- **路径重建**：从终点沿 came_from 回溯到起点，构造最优路径。
- **启发函数**：使用带对角修正的曼哈顿距离：
```python
(dx + dy) + (sqrt(2) - 2) * min(dx, dy)
```

#### 🌳 RRT 算法（`algorithm_RRT`）
- **核心思想**：随机采样 + 树结构扩展，寻找连接起点到终点的路径。
- **步骤**：
  1. 随机采样地图中的非障碍节点 `rand`；
  2. 从现有树中找到与其最接近的节点 `nearest`；
  3. 以指定步长 `L` 向该方向扩展新节点 `new_node`；
  4. 若 `new_node` 合法且接近终点，则回溯路径返回。
- **限制**：不能保证最优，可能需多次运行获取较优解。

#### 🧬 遗传算法 GA（`algorithm_GA`）
- **核心思想**：通过模拟生物进化的选择、交叉、变异机制优化路径代价。
- **编码方式**：个体为一条从起点到终点的路径（节点序列）。
- **选择策略**：采用锦标赛选择（Tournament Selection）。
- **交叉策略**：在两个父代路径中寻找共同节点，进行段交换（Common Subpath Crossover）。
- **变异策略**：随机替换路径中的一段为新生成路径段（基于 `generate_random_path_from`）。
- **适应度函数**：路径总代价 `path_cost()`。

#### 🐟 人工鱼群算法 AFSA（`algorithm_AFSA`）
- **核心思想**：仿照鱼类觅食、群聚、追尾等行为迭代搜索目标区域。
- **三个行为模型**：
  - `swarm`: 向邻域中多个鱼的平均位置靠近；
  - `follow`: 向邻域中代价最低的鱼靠近；
  - `prey`: 局部采样搜索比当前位置更优的位置。
- **动态机制**：
  - 步长 `step`：可随迭代逐步缩小，聚焦收敛；
  - 视野 `visual`：初期大范围探索，后期细粒收敛；
  - 拥挤度因子 `delta`：限制群聚密度防止陷入局部最优；
  - 随机扰动：当连续未改进时引入跳跃机制防止震荡停滞。

#### 🔀 GFSA（融合算法）
- **核心思想**：将 AFSA 所产生的路径作为 GA 初始种群，提高初始解质量。
- **子算法**：
  - `GFSA`: 默认启用所有 AFSA 动态机制；
  - `GFSA1`: 仅使用动态步长；
  - `GFSA2`: 仅使用动态拥挤度；
  - `GFSA3`: 仅使用动态随机概率。

通过切换 `algorithms = {}` 中的映射关系即可自由选择算法组合参与主函数测试。

### 📊 4. 可视化模块
- `plot_paths(env, results)`：
  - 使用 matplotlib 可视化展示地图障碍、起终点和各算法路径。
  - 每种路径使用不同颜色绘制，便于对比。

### 🧪 5. 主入口 `main()`

## ⚙️ 自定义运行方式

### 执行所有算法
```bash
main.py
```
### 选择要执行的算法
```bash
在main里的algorithms中修改即可
```
### 修改算法示例
```python
    algorithms = {
        "AStar": algorithm_AStar,
        "RRT": algorithm_RRT,
        "AFSA": algorithm_AFSA,
        "GA_Random": lambda env: algorithm_GA(env),
        "GFSA": algorithm_GFSA,
    }
```

### 修改参数示例
```python
algorithm_GA(env, population_size=80, generations=200)
algorithm_AFSA(env, use_variable_step=False, default_visual=3)
```
